import matplotlib.pyplot as plt
import matplotlib as mpl
from mpl_toolkits.mplot3d import Axes3D
from collections import Counter
from collections import OrderedDict
import numpy as np
from sklearn.ensemble import ExtraTreesClassifier
from sklearn.datasets import load_iris
from sklearn.feature_selection import SelectFromModel
from sklearn import svm
from sklearn import preprocessing
from sklearn.metrics import accuracy_score
from sklearn.preprocessing import PolynomialFeatures
import pickle

biRads = "5,5,4,5,5,3,4,4,4,3,4,4,5,5,4,5,5,5,4,5,5,4,4,4,5,4,4,4,5,5,5,4,5,4,5,5,4,5,4,4,4,4,5,5,5,4,5,4,5,5,4,5,3,5,5,4,4,5,5,5,4,4,4,5,5,4,4,5,5,5,4,4,5,4,5,5,5,5,5,5,4,5,4,5,5,4,4,5,5,4,4,5,5,4,4,3,4,5,4,4,4,5,4,4,5,5,4,4,4,4,5,4,5,5,4,5,4,4,5,5,5,5,4,5,5,4,4,5,4,5,4,4,4,3,4,2,4,5,4,4,4,4,5,5,4,4,4,3,3,4,5,5,5,4,5,4,4,3,5,5,4,5,5,4,4,4,5,4,4,3,5,4,4,5,4,3,4,5,4,4,5,5,5,5,5,5,4,4,5,4,5,3,5,5,5,5,5,2,4,5,5,4,5,4,4,4,4,4,4,5,5,5,4,5,4,4,5,4,4,5,5,4,3,4,4,2,4,4,4,4,5,4,4,4,4,4,4,4,4,5,4,5,4,4,4,4,4,5,5,4,5,5,4,5,5,5,4,55,5,4,4,4,5,4,5,5,4,5,4,4,5,4,4,4,5,4,5,4,5,3,4,4,5,5,4,5,4,5,4,5,5,4,4,5,5,4,4,4,4,5,5,4,4,5,5,4,3,5,4,5,5,5,5,5,3,4,5,5,4,5,4,5,5,5,4,5,5,5,4,4,4,5,5,5,4,5,5,4,5,4,4,5,4,5,5,4,5,5,5,4,4,5,4,4,5,5,5,4,4,4,4,5,4,5,4,4,5,5,4,5,4,5,4,4,4,4,4,5,4,5,4,4,4,4,4,4,4,5,4,5,5,4,5,5,4,4,5,5,4,4,4,4,5,5,5,5,4,4,5,4,5,3,4,5,4,5,4,2,5,5,5,5,5,4,4,4,5,4,4,4,3,4,4,5,4,4,5,4,5,6,3,4,4,4,4,5,4,5,5,4,4,5,5,4,4,4,4,4,4,4,5,4,4,5,4,4,4,4,5,4,4,5,4,5,5,5,4,5,5,5,5,4,5,4,4,5,4,4,4,5,5,4,4,5,5,5,5,5,4,5,4,5,4,4,4,4,5,4,5,5,4,4,4,4,5,5,4,5,4,4,4,5,4,4,5,4,4,4,5,4,4,5,4,5,4,4,4,5,5,4,2,5,5,6,5,4,5,4,5,5,5,4,5,5,5,5,4,4,4,4,5,5,5,4,5,5,4,6,4,4,4,4,4,4,5,4,4,4,4,4,5,4,6,4,4,4,4,4,5,4,4,4,6,6,4,4,4,5,5,4,5,5,4,4,4,5,4,4,3,4,4,4,4,4,4,4,4,4,4,5,4,5,4,4,4,5,4,4,5,5,5,5,4,5,5,5,4,5,4,4,4,5,4,2,5,4,4,3,4,4,4,4,3,5,4,6,4,4,4,4,4,4,4,4,4,3,5,5,5,4,5,5,4,4,4,5,5,4,5,4,5,5,5,4,4,4,4,4,4,5,4,4,4,4,5,5,4,4,5,4,6,5,4,5,4,4,4,4,4,4,5,4,4,4,4,4,5,4,4,4,4,4,4,4,4,4,4,5,5,5,5,4,5,4,5,4,2,4,5,4,5,4,4,4,4,3,5,4,4,5,4,3,4,4,5,5,6,5,4,4,4,4,4,5,4,4,4,4,4,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,4,5,4,4,4,4,4,4,4,4,4,4,4,4,4,5,4,5,4,4,4,4,4,5,4,4,4,4,4,4,4,5"
shape = "3,4,1,1,1,2,3,2,1,3,2,1,4,4,2,4,4,4,1,4,4,1,1,2,3,3,1,1,3,4,4,2,3,2,4,4,2,4,1,2,2,2,4,4,4,1,1,1,4,2,4,4,1,4,1,3,4,2,4,4,2,1,4,4,4,1,2,3,4,4,2,1,4,4,4,4,4,4,4,4,4,4,1,3,4,2,1,4,4,4,1,4,4,1,2,4,3,4,2,3,2,4,1,1,3,4,2,4,4,1,4,2,4,4,4,4,1,1,4,4,3,4,1,4,3,1,1,4,1,4,3,1,2,4,4,4,4,4,2,4,1,3,2,4,1,2,1,2,2,2,4,4,2,3,4,2,1,4,4,4,3,4,4,4,4,2,4,2,1,1,4,2,2,1,2,1,1,4,1,4,4,4,4,4,4,4,1,2,4,4,4,4,4,4,4,4,4,1,4,3,4,2,1,1,2,1,4,4,4,4,3,4,3,4,4,2,4,4,4,4,4,1,2,1,3,2,3,1,1,4,4,4,4,4,2,4,1,4,4,4,1,4,1,1,2,1,4,4,3,1,4,4,4,4,4,4,4,4,1,1,1,1,4,4,4,4,1,2,3,1,4,2,2,3,4,4,4,2,4,1,1,2,4,4,4,4,1,4,2,4,4,4,1,4,3,1,1,4,2,4,4,2,3,4,4,2,3,4,1,4,4,2,4,4,4,4,3,4,4,4,4,4,4,4,1,4,4,4,1,1,1,4,2,1,4,4,2,1,4,2,4,4,4,3,4,2,4,4,2,1,1,1,1,1,4,4,4,2,1,4,4,4,1,4,1,1,4,4,1,3,1,4,1,1,1,1,1,4,1,4,1,2,1,1,2,2,2,4,4,4,4,1,3,4,1,4,4,2,2,1,2,3,3,4,4,4,2,1,4,4,4,1,1,4,1,4,2,1,4,2,2,4,2,2,2,2,4,2,2,2,3,3,2,4,1,2,4,4,3,4,2,2,2,4,2,4,4,4,4,3,4,1,2,3,2,2,3,3,1,1,4,2,1,3,2,1,1,2,4,1,1,4,4,4,4,4,4,4,4,4,4,4,1,3,2,4,4,1,1,4,4,1,1,3,4,4,4,4,1,1,1,4,2,3,2,4,4,3,2,4,4,2,4,1,4,4,1,4,1,2,2,4,4,2,4,2,1,2,4,2,2,4,4,4,2,2,2,4,4,4,1,4,4,3,4,1,4,2,1,4,3,1,4,3,4,1,2,1,2,1,4,4,4,4,4,1,4,4,4,2,2,3,2,4,4,4,1,1,2,1,4,1,2,2,2,2,1,2,4,4,2,2,4,4,1,1,2,4,4,2,3,4,2,2,3,4,1,2,2,1,2,2,4,1,2,2,2,1,2,4,2,4,4,1,2,4,1,4,4,4,4,4,4,3,4,4,2,4,4,3,4,2,1,2,4,4,2,1,2,1,1,1,1,4,2,1,1,2,3,4,2,3,1,4,3,1,4,4,4,2,4,4,2,2,2,4,4,2,4,1,4,3,3,2,4,3,1,1,3,4,2,1,1,1,4,4,1,4,4,3,4,4,2,4,2,4,2,2,1,1,4,2,1,1,2,3,2,2,2,3,1,4,4,1,2,2,4,2,4,4,4,4,4,4,4,1,1,1,4,2,4,4,3,2,3,2,3,4,4,4,1,4,2,1,4,4,3,3,1,4,1,3,4,4,2,3,3,4,1,4,4,1,2,3,4,1,4,1,4,4,3,4,1,3,2,1,2,4,2,4,2,3,1,4,1,4,4,2,2,1,1,3,4,1,2,4,4,3,1,1,2,2,4,4,2,4,4,2,2,4,2,4,4,4"
margin = "5,5,1,5,4,1,1,1,1,4,1,1,3,4,4,5,5,4,5,4,4,1,1,1,4,4,1,1,5,5,5,1,5,1,3,3,5,4,1,1,1,1,3,5,4,1,1,1,3,4,5,4,1,4,5,4,4,1,4,4,1,1,4,4,4,1,1,4,5,4,1,1,4,3,5,4,3,4,4,5,4,4,1,5,5,1,1,5,4,4,1,4,4,1,4,4,4,4,1,1,1,5,1,1,5,5,1,4,4,1,5,1,5,4,4,4,1,1,5,4,4,4,1,3,1,1,1,4,1,4,1,1,1,4,5,4,5,5,3,3,1,1,1,5,1,4,1,1,1,1,5,4,1,4,4,1,1,3,3,3,1,5,5,5,4,1,4,1,1,1,4,3,1,5,1,1,1,4,1,4,2,4,5,4,3,4,1,1,2,4,5,3,4,5,4,2,4,1,4,1,5,1,4,1,1,1,3,3,3,5,4,4,1,5,4,4,4,4,5,4,5,1,1,1,1,1,1,1,1,5,4,1,4,3,3,4,1,4,2,3,1,5,1,1,1,1,4,5,5,1,5,3,4,5,3,4,4,3,1,4,1,1,5,1,4,5,2,1,1,1,4,1,1,1,4,4,4,1,4,1,3,1,4,4,5,4,1,4,3,3,5,4,1,3,5,1,1,4,1,4,4,3,1,3,3,1,4,4,1,4,3,4,3,4,5,4,4,4,3,2,2,4,3,4,1,4,2,4,1,1,1,3,4,1,4,5,4,1,3,3,4,4,5,4,4,3,3,4,3,1,5,4,3,1,5,4,3,1,1,3,5,5,1,5,1,1,5,3,1,4,1,5,1,1,1,1,1,4,1,3,1,3,1,1,1,1,1,5,4,5,5,1,3,4,1,4,5,4,1,1,1,1,4,4,5,5,1,3,5,4,5,1,1,5,1,5,3,1,5,4,4,4,4,2,1,1,5,1,1,1,1,1,1,5,1,1,5,4,4,5,1,1,1,3,3,5,3,5,4,4,4,4,4,4,1,1,3,3,1,1,5,1,1,2,2,1,1,2,4,1,1,4,4,4,2,4,4,5,4,3,3,4,5,3,1,5,4,1,1,4,5,1,1,4,5,5,5,3,1,5,3,5,2,4,4,4,5,3,4,4,1,1,4,1,5,5,1,5,1,1,1,5,4,1,5,1,1,4,5,4,4,4,1,4,1,1,1,4,4,3,1,4,3,5,3,1,5,4,4,3,3,2,3,3,2,1,1,1,1,1,3,1,4,4,3,4,4,4,4,1,1,4,1,4,4,3,1,1,4,1,3,1,1,1,1,1,1,4,5,5,3,4,4,3,1,1,1,4,4,1,4,4,1,1,1,4,1,1,1,1,1,4,4,1,4,1,1,1,1,4,1,3,4,1,1,4,1,4,4,4,5,3,4,3,3,3,1,3,3,3,5,4,1,1,3,4,4,1,1,1,1,1,1,5,1,1,1,1,3,4,1,4,1,3,4,1,4,4,4,1,3,4,1,1,3,4,4,1,4,4,5,4,2,1,4,2,4,1,1,3,1,1,1,1,4,3,1,5,4,3,3,4,1,5,1,4,2,1,1,1,4,1,1,1,1,1,1,1,1,1,1,5,4,1,4,1,4,5,5,4,3,2,4,4,4,1,1,1,5,1,4,5,3,1,1,4,2,4,5,4,1,4,4,1,5,3,3,2,1,4,1,3,5,3,1,4,4,4,1,4,5,1,1,3,5,1,5,1,5,4,1,5,1,4,4,1,1,4,1,4,1,2,1,3,1,3,3,1,1,1,1,3,4,1,4,4,3,4,1,4,1,4,5,4,1,5,4,4,1,4,1,5,5,5"
density = "3,3,3,3,3,3,2,2,3,3,3,3,1,3,3,3,3,3,2,3,3,2,3,3,2,2,1,3,2,3,3,2,3,1,3,3,3,3,3,3,3,2,3,3,3,3,2,3,2,1,3,2,3,3,3,3,3,3,3,3,3,3,3,3,2,3,2,3,3,3,2,3,3,2,3,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,4,4,3,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,4,3,2,3,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,3,3,3,3,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,1,3,3,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,3,2,3,3,3,3,4,4,3,2,3,3,3,3,3,3,3,3,3,2,3,3,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,3,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,3,3,3,3,3,3,3,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,3,2,3,3,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,2,2,3,3,2,3,3,3,2,3,3,3,2,2,3,3,3,3,3,3,3,4,3,3,3,2,3,3,3,1,3,3,3,3,2,3,3,3,3,3,3,3,2,3,3,3,3,3,2,3,2,3,3,3,3,2,3,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,3,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,3,3,3,3,3,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3"
age = "67,58,28,57,76,42,36,60,54,52,59,54,56,42,59,75,45,55,46,54,57,39,81,60,67,55,78,50,62,64,67,74,80,49,52,60,57,74,49,45,64,73,68,52,66,25,74,64,60,67,67,44,68,58,62,73,80,59,54,62,33,57,45,71,59,56,57,55,84,51,24,66,33,59,40,67,75,86,66,46,59,65,53,67,80,55,47,62,63,71,41,57,71,66,47,34,59,67,41,23,42,87,68,64,54,86,21,53,44,54,63,45,71,49,49,66,19,35,74,37,81,59,34,79,60,41,50,85,46,66,73,55,49,49,51,48,58,72,46,43,46,69,43,76,46,59,57,45,43,45,57,79,54,40,63,52,38,72,80,76,62,64,42,64,63,24,72,63,46,33,76,36,40,58,43,42,32,57,37,70,56,73,77,67,71,65,43,49,76,55,72,53,75,61,67,55,66,76,57,71,70,63,40,41,47,68,64,73,39,55,53,66,43,44,77,62,80,33,50,46,49,53,46,57,54,49,47,40,45,50,54,67,77,66,36,69,48,64,71,60,24,34,79,45,37,42,72,60,85,51,54,55,64,67,75,87,46,46,61,44,32,62,59,61,78,42,45,34,27,43,83,36,37,56,55,88,71,41,49,51,39,46,52,58,67,80,45,68,44,74,55,49,49,50,52,45,66,68,72,74,58,77,49,60,69,53,46,74,58,68,46,61,70,37,65,67,69,76,65,72,62,42,66,48,35,60,67,78,66,48,31,43,72,66,56,58,33,37,36,39,39,83,68,63,78,38,46,60,56,33,69,66,72,29,54,80,68,35,50,32,71,87,64,55,18,53,84,80,32,77,38,54,63,61,52,36,59,51,36,40,49,37,46,63,28,47,42,44,49,47,52,53,83,63,54,50,80,45,28,31,41,21,44,49,71,75,38,60,87,70,55,21,50,76,23,73,38,57,65,67,61,56,71,49,44,27,73,34,50,62,21,36,45,67,21,57,66,71,69,80,27,38,23,46,61,65,60,83,40,53,76,79,38,61,56,44,66,50,46,39,55,40,26,84,41,63,49,56,65,54,36,49,59,75,59,59,28,53,57,77,85,59,59,65,54,46,63,53,56,66,66,55,44,86,47,59,66,61,69,93,39,44,45,51,56,66,61,64,57,79,44,31,63,64,47,68,30,43,56,46,67,52,67,47,58,28,43,57,68,64,64,62,38,68,41,35,68,55,67,51,40,73,59,60,54,56,53,54,79,67,64,70,55,65,45,49,24,52,50,35,64,40,66,64,52,43,56,51,79,22,73,53,59,46,66,50,58,55,62,60,57,57,41,71,32,57,19,62,67,50,65,40,71,68,68,29,53,66,76,58,96,70,34,59,45,65,59,21,43,53,65,64,53,51,59,56,60,22,25,69,58,62,56,64,32,59,52,63,67,61,59,52,35,77,71,63,38,72,76,53,67,69,54,35,68,68,67,39,44,33,58,31,23,56,69,63,65,44,62,67,56,52,43,41,42,46,55,58,87,66,60,83,31,53,64,31,62,56,58,67,75,65,74,59,57,76,63,44,42,65,70,48,74,63,60,86,27,71,85,51,72,52,66,71,42,64,41,50,30,67,62,46,35,53,59,19,86,72,37,46,45,48,58,42,56,47,49,76,62,64,53,70,55,34,76,39,23,19,65,57,41,36,62,69,41,51,50,47,54,52,30,48,65,50,65,66,41,72,42,80,41,72,60,67,55,61,55,52,42,63,62,46,65,57,66,45,77,35,50,57,74,59,51,42,35,42,43,62,27,57,59,40,20,74,22,57,57,55,62,54,71,65,68,64,54,48,58,58,70,70,59,57,53,54,53,67,68,56,35,52,47,56,64,66"
results = "1,1,0,1,1,1,0,0,0,0,1,1,1,1,1,1,1,0,0,1,1,0,0,0,1,0,0,0,1,1,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,0,1,0,1,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,0,0,0,1,0,1,0,0,0,0,1,1,1,0,1,1,1,1,0,1,1,0,0,1,1,1,0,1,1,0,0,0,0,1,0,0,0,1,1,0,1,1,0,0,0,0,1,0,0,1,0,0,0,0,1,1,1,1,0,1,0,1,0,1,0,1,0,0,0,0,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,1,0,0,0,1,1,0,1,0,0,1,0,1,0,0,0,1,0,0,1,0,0,0,1,0,1,1,1,1,1,1,1,0,0,1,0,1,0,1,1,1,1,1,0,1,0,1,0,1,0,0,1,1,0,0,1,0,1,0,1,1,0,1,0,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,0,1,0,0,0,0,1,1,1,0,1,1,0,1,1,1,1,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,0,1,1,1,1,0,1,0,0,0,1,1,1,1,0,1,0,1,0,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,0,1,0,1,0,1,1,1,1,0,0,1,0,1,0,1,1,1,0,1,1,1,1,0,0,1,0,1,0,1,1,0,1,0,1,1,1,1,1,0,1,1,1,0,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,1,0,1,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,1,0,1,1,1,1,1,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,1,1,0,0,1,0,1,0,0,1,1,1,0,1,0,0,0,1,0,1,0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,0,1,0,1,1,0,0,1,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,1,0,0,0,0,1,1,0,1,1,0,0,0,1,0,1,1,0,1,1,1,0,1,1,0,0,1,1,1,0,1,0,1,0,1,0,0,0,0,1,1,0,1,0,0,0,0,0,1,0,1,0,0,0,1,1,0,1,0,0,0,1,0,0,1,0,1,0,1,0,1,1,0,0,1,1,1,0,0,1,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,0,1,1,0,0,0,1,0,1,1,1,0,1,0,1,0,0,1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,1,1,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,1,0,1,1,1,0,1,1,0,0,1,0,0,1,0,1,0,0,0,0,0,0,1,1,0,1,0,1,1,0,0,1,1,0,0,1,1,1,0,1,1,0,0,0,1,1,0,1,0,1,1,1,0,1,0,0,0,0,1,0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,1,0,1,0,1,1,1,1,1,1,1,0,1,0,0,0,1,0,1,1,0,0,0,0,1,0,1,1,0,1,1,0,1,1,1,1,1,1,0,1,0,1,0,1,1,1,0,1,1,0,0,1,1,0,1,0,1,0,1,0,0,1,0,0,0,1,0,1,0,1,0,1,0,0,1,0,0,0,1,0,0,0,0,1,0,1,0,1,0,0,0,1,0,1,1,0,0,1,0,1,0,1"

biRadsX = map(float, biRads.split(","))
shapeX = map(float,shape.split(","))
marginX = map(float,margin.split(","))
densityX = map(float,density.split(","))
resultY = map(float,results.split(","))
ageX = map(float,age.split(","))
y = resultY
dataSplit = 43
  
allFeatures = [ageX, shapeX, densityX, marginX]
X = []
for i in range(0, len(resultY)):
   X.append([])
   for c in range(0, len(allFeatures)):
      X[i].append(allFeatures[c][i])         
X = preprocessing.scale(X)      

mamSVM = None
guesses = None
distancesFromBoundary = None #confidence interval
rightOrWrongArr = None

def dataTrainingandPredicting():
   global mamSVM
   global guesses
   global distancesFromBoundary 
   mamSVM = svm.SVC(kernel='linear', gamma=23.4, C=7.0) #best gamma and C = 0.3, 0.1 respectively
   mamSVM.fit(X[0:dataSplit],resultY[0:dataSplit]) #Right now using x and works with any number of features
   guesses = []
   distancesFromBoundary = []
   for i in range(dataSplit,len(resultY)): 
      guesses.append(int(mamSVM.predict([X[i]])))  
      distancesFromBoundary.append(float(mamSVM.decision_function([X[i]])))

def getAccuracy(): 
   dataTrainingandPredicting()
   return mamSVM.score(X[dataSplit:len(resultY)],resultY[dataSplit:len(resultY)])
   
def getRightOrWrongIndexes(): 
   global rightOrWrongArr
   rightOrWrongArr = []
   for i in range(dataSplit, len(resultY)):
      guessesIndex = i-dataSplit  
      if(guesses[guessesIndex] == resultY[i]): 
         rightOrWrongArr.append('right')
      else: 
         rightOrWrongArr.append('r')  
   return rightOrWrongArr  
      
def getPositiveAccuracy(temp):
   total = 0
   right = 0
   for i in range(dataSplit,dataSplit+len(temp)): 
      tempIndex = (i-dataSplit)
      if(resultY[i] == 1): 
         total = total + 1
         if(temp[tempIndex] == 1): 
            right = right + 1      
   return float(right)/float(total)
   
def getNegativeAccuracy(temp):
   total = 0
   right = 0
   for i in range(dataSplit,dataSplit+len(temp)): 
      tempIndex = (i-dataSplit)
      if(resultY[i] == 0): 
         total = total + 1
         if(temp[tempIndex] == 0): 
            right = right + 1      
   return float(right)/float(total)
         
def getSpecificity(temp): 
   #tn/tn+fp
   tn = 0
   fp = 0
   for i in range(dataSplit, dataSplit+len(temp)):
      tempIndex = i-dataSplit
      if((resultY[i] == temp[tempIndex]) and temp[tempIndex] == 0): 
         tn += 1
      if((resultY[i] == 0) and temp[tempIndex] == 1):
         fp += 1
   return float(tn)/(float(tn)+float(fp))
   
def getSensitivity(temp): 
   #tp/tp+fn
   tp = 0
   fn = 0
   for i in range(dataSplit, dataSplit+len(temp)):
      tempIndex = i-dataSplit
      if((resultY[i] == temp[tempIndex]) and temp[tempIndex] == 1): 
         tp += 1
      if((resultY[i] == 1) and temp[tempIndex] == 0):
         fn += 1
   return float(tp)/(float(tp)+float(fn))
   
if __name__ == '__main__':
    
   print("Overall accuracy: " + str(getAccuracy()*100))
   print("Positive Accuracy: " + str(getPositiveAccuracy(guesses)*100))
   print("Negative Accuracy: " + str(getNegativeAccuracy(guesses)*100)) 
   print("Sensitivity: " + str(getSensitivity(guesses)*100))
   print("Specificity: " + str(getSpecificity(guesses)*100))
   
   
